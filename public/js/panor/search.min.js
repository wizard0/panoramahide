'use strict';function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}(function(a){var b=function(){function c(){_classCallCheck(this,c),this.savedSearchLoaded=!1,this.settings={form:null,deleteSearchContainer:'._delete_search',saveSearch:'._save_search',savedSearch:'._saved_search',savedSearchDelete:'._saved_search_delete',savedSearchApply:'._saved_search_apply',savedSearchContainer:'._saved_search_container'},this.isExtendHandler=function(){throw new Error('Not implemented')},this.toggleExtendHandler=function(){throw new Error('Not implemented')}}return c.prototype.isExtend=function isExtend(){return this.isExtendHandler.call(this)},c.prototype.toggleExtend=function toggleExtend(){return this.toggleExtendHandler.call(this)},c.prototype.getFormData=function getFormData(){var d;return d=this.settings.form.serializeArray(),d=d.filter(function(e){return e.value}),this.isExtend()&&d.push({name:'extend',value:'1'}),d},c.prototype.loadSavedSearch=function loadSavedSearch(){var d=this;this.savedSearchLoaded||load('/ajax/saved_search.php',this.settings.savedSearchContainer,function(){d.savedSearchLoaded=!0})},c.prototype.showSearchSave=function showSearchSave(){$(this.settings.saveSearch).show(),this.hideSearchDelete()},c.prototype.hideSearchSave=function hideSearchSave(){$(this.settings.saveSearch).hide()},c.prototype.showSearchDelete=function showSearchDelete(d){$(this.settings.deleteSearchContainer).data('id',d).show(),this.settings.form.find('[name=searchID]').val(d),this.hideSearchSave()},c.prototype.hideSearchDelete=function hideSearchDelete(){$(this.settings.deleteSearchContainer).find('[name=searchID]').val(''),$(this.settings.deleteSearchContainer).data('id','').hide()},c.prototype.resetForm=function resetForm(){this.settings.form.find('input').each(function(d,e){-1==['checkbox','radio'].indexOf($(e).attr('type'))?$(e).val(''):$(e).removeAttr('checked')}),this.settings.form.find('select').each(function(d,e){$(e).find('option').removeAttr('selected')}),this.hideSearchSave(),this.hideSearchDelete()},c.prototype.deleteSavedSearch=function deleteSavedSearch(d){var e=$(this.settings.savedSearch+'[data-id='+d+']'),f=e.find(this.settings.savedSearchDelete),h=this;ajax('search',{action:'delete',id:d},function(j){j.ids?j.ids.forEach(function(k){var l=$(h.settings.savedSearch+'[data-id='+k+']');l.slideUp(time_animation,function(){l.remove()})}):e.slideUp(time_animation,function(){e.remove()}),h.hideSearchDelete()},function(j){notice(j,'error',f,{position:'right middle'})})},c.prototype.applySavedSearch=function applySavedSearch(d){this.resetForm();var e=$(this.settings.savedSearch+'[data-id='+d+']'),f=e.data();for(var g in f)if('extend'==g)this.isExtend()||this.toggleExtend();else{var h=this.settings.form.find('[name='+g+']');if(!h.length)continue;'checkbox'==h.attr('type')||'radio'==h.attr('type')?(h=this.settings.form.find('[name='+g+'][value='+f[g]+']'),h.prop('checked',!0)):'SELECT'==h.get(0).tagName?h.val(f[g]):h.val(f[g])}notice(MESS.FILTER_APPLIED,'success',e.find(this.settings.savedSearchApply),{position:'bottom left'}),this.hideSearchSave(),this.showSearchDelete(d)},c.prototype.saveSearch=function saveSearch(){var d={action:'save',data:this.getFormData()},e=this;ajax('search',d,function(f){e.savedSearchLoaded=!1,e.hideSearchSave(),e.showSearchDelete(f.ID),notice(MESS.SEARCH_SAVED,'success',$(e.settings.deleteSearchContainer),{position:'bottom left'})},function(f){notice(f,'error',$(e.settings.saveSearch),{position:'bottom center'})})},c}();a.search=new b})(window.P);